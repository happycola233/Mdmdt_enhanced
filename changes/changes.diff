diff --git a/mdmdt-dark.css b/mdmdt-dark.css
index 6e5e560..6a92545 100644
--- a/mdmdt-dark.css
+++ b/mdmdt-dark.css
@@ -33,6 +33,7 @@
   --color-4: #8250df;
   --color-4-0-a: rgba(130, 80, 223, 0.3);
   --color-4-0-b: rgba(130, 80, 223, 0.12);
+  --color-4-0-c: rgba(130, 80, 223, 0.42);
 
   --color-5: #e30f2e;
   --color-5-0-a: rgba(227, 15, 46, 0.3);
@@ -50,7 +51,8 @@
   --side-bar-bg-color: var(--bg-color);
   --item-hover-bg-color: var(--bg-color2);
   --item-hover-text-color: var(--color-1);
-  --select-text-bg-color: var(--color-1-0-a);
+  --select-text-bg-color: var(--color-4-0-c);
+  --codeblock-bg-color: var(--bg-color2);
   --monospace: "JetBrains Mono", "Source Code Pro", "Fira Code", Consolas, Inconsolata, "Cascadia Code", Monaco, "Ubuntu Mono", monospace;
 
   --mermaid-theme: dark; /*or base, dark, forest, neutral, night */
@@ -253,12 +255,24 @@ del {
 
 mark {
   border-radius: 5px;
-  background-color: var(--color-1);
+  background-color: rgba(255, 236, 153, 0.85);
   padding: 0 4px;
-  color: rgb(250, 250, 250);
+  color: var(--bg-color);
   box-decoration-break: clone;
   -webkit-box-decoration-break: clone;
 }
+mark code {
+  background: transparent;
+  color: var(--bg-color);
+}
+
+/* Keep inline background spans readable when themes switch */
+#write span[style*="background"],
+#write span[style*="background-color"],
+.typora-export-content span[style*="background"],
+.typora-export-content span[style*="background-color"] {
+  color: #000 !important;
+}
 
 /*
  * ------------------------
@@ -528,7 +542,7 @@ pre {
   margin-top: 16px;
   margin-bottom: 0;
   box-sizing: border-box;
-  background: var(--bg-color2) !important;
+  background: var(--codeblock-bg-color) !important;
   border-radius: 8px;
   font-size: 14px !important;
   color: var(--text-code);
@@ -651,7 +665,7 @@ kbd {
   color: rgb(250, 250, 250);
 }
 ::selection {
-  background: var(--color-2-0-c);
+  background: var(--color-4-0-c);
   box-decoration-break: clone;
   -webkit-box-decoration-break: clone;
 }
@@ -1398,7 +1412,7 @@ li > .outline-item:hover::before,
   padding: 8px;
 }
 .ty-file-search-match-text {
-  background-color: var(--color-2-0-c);
+  background-color: var(--color-4-0-c);
 }
 
 /*
@@ -1631,7 +1645,7 @@ li > .outline-item:hover::before,
 .cm-s-inner .CodeMirror-line::-moz-selection,
 .cm-s-inner .CodeMirror-line > span::-moz-selection,
 .cm-s-inner .CodeMirror-line > span > span::-moz-selection {
-  background: var(--color-2-0-c);
+  background: var(--color-4-0-c);
 }
 .cm-s-inner .CodeMirror-activeline-background { background: transparent; }
 .cm-s-inner .cm-keyword { color: #bb59fd; }
@@ -2368,12 +2382,12 @@ footer.ty-footer,
   color: var(--color-2);
 }
 .md-search-hit {
-  background: var(--color-2-0-c) !important;
-  color: #070909 !important;
+  background: var(--color-4-0-c) !important;
+  color: var(--title-color) !important;
 }
 .md-search-select {
-  background: var(--color-2) !important;
-  color: #070909 !important;
+  background: var(--color-4) !important;
+  color: rgb(250, 250, 250) !important;
 }
 
 /* md-notification-container */
@@ -2753,4 +2767,4 @@ body.typora-export {
       font-size: 9pt;
     }
   }
-}
\ No newline at end of file
+}






diff --git a/mdmdt-light.css b/mdmdt-light.css
index 6085497..8fe17be 100644
--- a/mdmdt-light.css
+++ b/mdmdt-light.css
@@ -34,6 +34,7 @@
   --color-4: #8250df;
   --color-4-0-a: rgba(130, 80, 223, 0.15);
   --color-4-0-b: rgba(130, 80, 223, 0.06);
+  --color-4-0-c: rgba(130, 80, 223, 0.28);
 
   --color-5: #e30f2e;
   --color-5-0-a: rgba(227, 15, 46, 0.15);
@@ -51,7 +52,8 @@
   --side-bar-bg-color: var(--bg-color);
   --item-hover-bg-color: var(--bg-color2);
   --item-hover-text-color: var(--color-1);
-  --select-text-bg-color: var(--color-1-0-a);
+  --select-text-bg-color: var(--color-4-0-c);
+  --codeblock-bg-color: rgb(245, 245, 245);
   --monospace: "JetBrains Mono", "Source Code Pro", "Fira Code", Consolas, Inconsolata, "Cascadia Code", Monaco, "Ubuntu Mono", monospace;
 
   /*--mermaid-theme: neutral;*/ /*or base, dark, forest, neutral, night*/
@@ -254,12 +256,16 @@ del {
 
 mark {
   border-radius: 5px;
-  background-color: var(--color-1);
+  background-color: rgba(255, 236, 153, 0.85);
   padding: 0 4px;
-  color: var(--bg-color);
+  color: var(--title-color);
   box-decoration-break: clone;
   -webkit-box-decoration-break: clone;
 }
+mark code {
+  background: transparent;
+  color: inherit;
+}
 
 /*
  * ------------------------
@@ -529,7 +535,7 @@ pre {
   margin-top: 16px;
   margin-bottom: 0;
   box-sizing: border-box;
-  background: var(--bg-color2) !important;
+  background: var(--codeblock-bg-color) !important;
   border-radius: 8px;
   font-size: 14px !important;
   color: var(--text-code);
@@ -549,7 +555,7 @@ pre .CodeMirror-sizer {
   padding-left: 4px;
 }
 pre .CodeMirror-gutters {
-  background: var(--bg-color2);
+  background: var(--codeblock-bg-color);
   border-color: var(--border-color);
 }
 
@@ -652,7 +658,7 @@ kbd {
   color: var(--bg-color);
 }
 ::selection {
-  background: var(--color-2-0-c);
+  background: var(--color-4-0-c);
   box-decoration-break: clone;
   -webkit-box-decoration-break: clone;
 }
@@ -1396,7 +1402,7 @@ li > .outline-item:hover::before,
   padding: 8px;
 }
 .ty-file-search-match-text {
-  background-color: var(--color-2-0-c);
+  background-color: var(--color-4-0-c);
 }
 
 /*
@@ -1629,7 +1635,7 @@ li > .outline-item:hover::before,
 .cm-s-inner .CodeMirror-line::-moz-selection,
 .cm-s-inner .CodeMirror-line > span::-moz-selection,
 .cm-s-inner .CodeMirror-line > span > span::-moz-selection {
-  background: var(--color-2-0-c);
+  background: var(--color-4-0-c);
 }
 .cm-s-inner .CodeMirror-activeline-background { background: transparent; }
 .cm-s-inner .cm-keyword { color: #bb59fd; }
@@ -2365,12 +2371,12 @@ footer.ty-footer,
   color: var(--color-2);
 }
 .md-search-hit {
-  background: var(--color-2-0-c) !important;
-  color: #070909 !important;
+  background: var(--color-4-0-c) !important;
+  color: var(--title-color) !important;
 }
 .md-search-select {
-  background: var(--color-2) !important;
-  color: #070909 !important;
+  background: var(--color-4) !important;
+  color: rgb(250, 250, 250) !important;
 }
 
 /* md-notification-container */
@@ -2749,4 +2755,4 @@ body.typora-export {
       font-size: 9pt;
     }
   }
-}
\ No newline at end of file
+}




diff --git a/mdmdt.css b/mdmdt.css
index c3e526e..7c7b985 100644
--- a/mdmdt.css
+++ b/mdmdt.css
@@ -34,6 +34,7 @@
   --color-4: #8250df;
   --color-4-0-a: rgba(130, 80, 223, 0.15);
   --color-4-0-b: rgba(130, 80, 223, 0.06);
+  --color-4-0-c: rgba(130, 80, 223, 0.28);
 
   --color-5: #e30f2e;
   --color-5-0-a: rgba(227, 15, 46, 0.15);
@@ -51,7 +52,8 @@
   --side-bar-bg-color: var(--bg-color);
   --item-hover-bg-color: var(--bg-color2);
   --item-hover-text-color: var(--color-1);
-  --select-text-bg-color: var(--color-1-0-a);
+  --select-text-bg-color: var(--color-4-0-c);
+  --codeblock-bg-color: rgb(245, 245, 245);
   --monospace: "JetBrains Mono", "Source Code Pro", "Fira Code", Consolas, Inconsolata, "Cascadia Code", Monaco, "Ubuntu Mono", monospace;
 
   /*--mermaid-theme: neutral;*/ /*or base, dark, forest, neutral, night*/
@@ -254,12 +256,24 @@ del {
 
 mark {
   border-radius: 5px;
-  background-color: var(--color-1);
+  background-color: rgba(255, 236, 153, 0.85);
   padding: 0 4px;
-  color: var(--bg-color);
+  color: var(--title-color);
   box-decoration-break: clone;
   -webkit-box-decoration-break: clone;
 }
+mark code {
+  background: transparent;
+  color: inherit;
+}
+
+/* Keep inline background spans readable when themes switch */
+#write span[style*="background"],
+#write span[style*="background-color"],
+.typora-export-content span[style*="background"],
+.typora-export-content span[style*="background-color"] {
+  color: #000 !important;
+}
 
 /*
  * ------------------------
@@ -529,7 +543,7 @@ pre {
   margin-top: 16px;
   margin-bottom: 0;
   box-sizing: border-box;
-  background: var(--bg-color2) !important;
+  background: var(--codeblock-bg-color) !important;
   border-radius: 8px;
   font-size: 14px !important;
   color: var(--text-code);
@@ -549,7 +563,7 @@ pre .CodeMirror-sizer {
   padding-left: 4px;
 }
 pre .CodeMirror-gutters {
-  background: var(--bg-color2);
+  background: var(--codeblock-bg-color);
   border-color: var(--border-color);
 }
 
@@ -652,7 +666,7 @@ kbd {
   color: var(--bg-color);
 }
 ::selection {
-  background: var(--color-2-0-c);
+  background: var(--color-4-0-c);
   box-decoration-break: clone;
   -webkit-box-decoration-break: clone;
 }
@@ -1396,7 +1410,7 @@ li > .outline-item:hover::before,
   padding: 8px;
 }
 .ty-file-search-match-text {
-  background-color: var(--color-2-0-c);
+  background-color: var(--color-4-0-c);
 }
 
 /*
@@ -1628,7 +1642,7 @@ li > .outline-item:hover::before,
 .cm-s-inner .CodeMirror-line::-moz-selection,
 .cm-s-inner .CodeMirror-line > span::-moz-selection,
 .cm-s-inner .CodeMirror-line > span > span::-moz-selection {
-  background: var(--color-2-0-c);
+  background: var(--color-4-0-c);
 }
 .cm-s-inner .CodeMirror-activeline-background { background: transparent; }
 .cm-s-inner .cm-keyword { color: #bb59fd; }
@@ -2364,12 +2378,12 @@ footer.ty-footer,
   color: var(--color-2);
 }
 .md-search-hit {
-  background: var(--color-2-0-c) !important;
-  color: #070909 !important;
+  background: var(--color-4-0-c) !important;
+  color: var(--title-color) !important;
 }
 .md-search-select {
-  background: var(--color-2) !important;
-  color: #070909 !important;
+  background: var(--color-4) !important;
+  color: rgb(250, 250, 250) !important;
 }
 
 /* md-notification-container */
@@ -2700,11 +2714,13 @@ body.typora-export {
 
     --color-4-0-a: rgba(130, 80, 223, 0.3);
     --color-4-0-b: rgba(130, 80, 223, 0.12);
+    --color-4-0-c: rgba(130, 80, 223, 0.42);
 
     --color-5-0-a: rgba(227, 15, 46, 0.3);
     --color-5-0-b: rgba(227, 15, 46, 0.12);
 
     --md-char-color: #667c89ff;
+    --codeblock-bg-color: var(--bg-color2);
     --mermaid-theme: dark;
   }
   /* scroll style */
@@ -2723,7 +2739,11 @@ body.typora-export {
     color: #cfdfff;
   }
   mark {
-    color: rgb(250, 250, 250);
+    color: var(--bg-color);
+  }
+  mark code {
+    background: transparent;
+    color: var(--bg-color);
   }
   kbd {
     background: var(--color-2);
@@ -2833,4 +2853,4 @@ body.typora-export {
       font-size: 9pt;
     }
   }
-}
\ No newline at end of file
+}
